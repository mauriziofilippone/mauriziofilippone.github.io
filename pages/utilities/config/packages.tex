% Acronyms
\usepackage{scalefnt,letltxmacro}
\LetLtxMacro{\oldtextsc}{\textsc}
\renewcommand{\textsc}[1]{\oldtextsc{\scalefont{1.10}#1}}
\usepackage[acronym,nowarn]{glossaries}
\glsdisablehyper
\makeglossaries
\usepackage{xspace}
\usepackage{float}
\usepackage{physics}

% Maths
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage[ruled,vlined]{algorithm2e}
\usepackage[]{microtype}


% color
\usepackage[usenames,dvipsnames]{xcolor}
\definecolor{shadecolor}{gray}{0.9}
\newcommand{\red}[1]{\textcolor{BrickRed}{#1}}
\newcommand{\orange}[1]{\textcolor{BurntOrange}{#1}}
\newcommand{\green}[1]{\textcolor{OliveGreen}{#1}}
\newcommand{\blue}[1]{\textcolor{MidnightBlue}{#1}}
\newcommand{\sky}[1]{\textcolor{SkyBlue}{#1}}
\newcommand{\gray}[1]{\textcolor{black!60}{#1}}

% hyperref
\usepackage[colorlinks,linktoc=all]{hyperref}
\usepackage[all]{hypcap}
\hypersetup{citecolor=red}
\hypersetup{linkcolor=red}
\hypersetup{urlcolor=red}
%% \hypersetup{citecolor=MidnightBlue}
%% \hypersetup{linkcolor=MidnightBlue}
%% \hypersetup{urlcolor=MidnightBlue}



% cleverref
\usepackage[capitalize,nameinlink]{cleveref}
\crefname{section}{\S}{\S\S}
\Crefname{section}{\S}{\S\S}
\creflabelformat{equation}{#2\textup{#1}#3}
\providecommand\algorithmname{algorithm}


% Other           
\DeclareRobustCommand{\parhead}[1]{\textbf{#1}~}

% For crossferencing across documents
\makeatletter
\newcommand*{\addFileDependency}[1]{% argument=file name and extension
	\typeout{(#1)}
	\@addtofilelist{#1}
	\IfFileExists{#1}{}{\typeout{No file #1.}}
}
\makeatother
\newcommand*{\myexternaldocument}[1]{%
	\externaldocument{#1}%
	\addFileDependency{#1.tex}%
	\addFileDependency{#1.aux}%
}
% Figures
\usepackage{nidanfloat}
\usepackage[font=small,labelfont=bf,tableposition=top]{caption}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage[format=hang]{subcaption}
\usepackage{wrapfig}

\usepackage{pgfplots}
\pgfplotsset{compat=1.6}
\usepgfplotslibrary{groupplots}
%% Use sans serif font for pictures
\tikzstyle{every picture}+=[font=\sffamily]
\tikzstyle{optimized} = [circle,fill=white,draw=black, dashed,inner sep=1pt, minimum size=20pt, font=\fontsize{10}{10}\selectfont, node distance=1]
\pgfkeys{/pgf/number format/.cd,1000 sep={}}
\pgfplotsset{
	tick label style = {font=\sffamily},
	every axis label/.append style={font=\sffamily},
	typeset ticklabels with strut,
}
\pgfplotsset{every axis/.append style={
			every x tick label/.append style={font=\fontsize{3.5pt}{3pt}\sffamily, yshift=.5ex,},
			every y tick label/.append style={font=\fontsize{3.5pt}{3pt}\sffamily, xshift=.8ex},
			every y label/.append style={xshift=10ex}
		},
}
\newlength\figureheight
\newlength\figurewidth
\usepgfplotslibrary{external}
\tikzexternalize[mode=list and make]
% \tikzexternalize
\newcommand{\tikzfile}[1]{
	\tikzsetnextfilename{#1}%  
	\input{#1.tikz}
}



% ********************************************************************
% Notes and todos
% ********************************************************************
\usepackage[colorinlistoftodos,
	% disable,
	textsize=scriptsize,
	linecolor=red!30,
	bordercolor=red!30,
	backgroundcolor=red!10]{todonotes}
% \makeatletter
\renewcommand{\todo}[2][]{\tikzexternaldisable\@todo[#1]{#2}\tikzexternalenable}
% \makeatother
\newcommand{\note}[1]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum, inline, ]{\color{Plum!80!black}{\textbf{\textit{#1}}}}}


\usepackage[most]{tcolorbox}
\newenvironment{highlight}%
{\begin{tcolorbox}[toprule=2mm,left=4pt,right=4pt,top=0pt,bottom=1pt,boxsep=2pt, before skip = 2ex, after skip =2ex]}{\end{tcolorbox}}
\tcbset{boxsep=4pt,left=2pt,right=2pt,top=-0pt,bottom=0pt}


\newcommand\noteMF[1]{{\color{red}{ \footnotesize {\textbf{\textsc{MF}} - ``#1''}\xspace}}}
\newcommand\notePM[1]{{\color{blue}{ \footnotesize {\textbf{\textsc{PM}} - ``#1''}\xspace}}}
\newcommand\noteDM[1]{{\color{magenta}{ \footnotesize {\textbf{\textsc{DM}} - ``#1''}\xspace}}}
\newcommand\noteBH[1]{{\color{violet}{ \footnotesize {\textbf{\textsc{BH}} - ``#1''}\xspace}}}



\usepackage{url}

\usepackage{xr}
\externaldocument{supplementary}

%\usepackage{algorithm}
%\usepackage{algorithmic}
\usepackage{subcaption}

\usepackage{tikz}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
% \usepackage{amsthm} % theorems and proofs
% \newtheorem{theorem}{Theorem}
% \newtheorem{proposition}{Proposition}

\usepackage{adjustbox}
\usepackage{multirow}
\usepackage{mathtools}
%\DeclareMathOperator{\Hessian}{H}
%\DeclareMathOperator{\Hessian}{\mathbf{H}}
\DeclareMathOperator{\Hessian}{Hess}

\usepackage{xspace}

%\hypersetup{draft}
\newcommand{\redquestionmark}{\textbf{\textcolor{red!60!black}{?}}}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ======= DEBUG FOR MISSING REFERENCES (Uncomment if needed)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \makeatletter
% \let\oldcitation\citation
% \def\xcomma{}
% \def\bibList{}
% \def\citation#1{%
%     \@for\xx:=#1\do{%
%       \expandafter\ifx\csname bbl@\xx\endcsname\relax%
%         \expandafter\gdef\csname bbl@\xx\endcsname{0}%
%         \xdef\bibList{\bibList\xcomma\xx}%
%         \def\xcomma{,}%
%       \fi%
%     }%
%     \oldcitation{#1}%
% }
% \AtEndDocument{\@bsphack
%   \protected@write\@auxout{}%
%          {\string\BibList{\bibList}}%
%   \@esphack}
% \def\xComma{}
% \def\biblostkeys{}
% \def\BibList#1{%
%    \@for\xx:=#1\do{%
%       \expandafter\ifx\csname BBL@\xx\endcsname\relax%
%         \xdef\biblostkeys{\biblostkeys\xComma\xx}%
%         \def\xComma{,\space}%
%       \fi%
%    }%
% }
% \def\refnotcalled{}
% \def\Xcomma{}
% \let\oldbibcite\bibcite
% \def\bibcite#1{%
%    \expandafter\gdef\csname BBL@#1\endcsname{0}%
%    \expandafter\ifx\csname bbl@#1\endcsname\relax% Not cited
%      \xdef\refnotcalled{\refnotcalled\Xcomma#1}%
%      \def\Xcomma{,\space}%
%    \fi%
%    \oldbibcite{#1}%
% }
% \def\NAT@citex%
%   [#1][#2]#3{%
%   \NAT@reset@parser
%   \NAT@sort@cites{#3}%
%   \NAT@reset@citea
%   \@cite{\let\NAT@nm\@empty\let\NAT@year\@empty
%     \@for\@citeb:=\NAT@cite@list\do
%     {\@safe@activestrue
%      \edef\@citeb{\expandafter\@firstofone\@citeb\@empty}%
%      \@safe@activesfalse
%      \@ifundefined{b@\@citeb\@extra@b@citeb}{\@citea%
%        {\reset@font\bfseries?\@citeb?}\NAT@citeundefined
%                  \PackageWarning{natbib}%
%        {Citation `\@citeb' on page \thepage \space undefined}\def\NAT@date{}}%
%      {\let\NAT@last@nm=\NAT@nm\let\NAT@last@yr=\NAT@year
%       \NAT@parse{\@citeb}%
%       \ifNAT@longnames\@ifundefined{bv@\@citeb\@extra@b@citeb}{%
%         \let\NAT@name=\NAT@all@names
%         \global\@namedef{bv@\@citeb\@extra@b@citeb}{}}{}%
%       \fi
%      \ifNAT@full\let\NAT@nm\NAT@all@names\else
%        \let\NAT@nm\NAT@name\fi
%      \ifNAT@swa\ifcase\NAT@ctype
%        \if\relax\NAT@date\relax
%          \@citea\NAT@hyper@{\NAT@nmfmt{\NAT@nm}\NAT@date}%
%        \else
%          \ifx\NAT@last@nm\NAT@nm\NAT@yrsep
%             \ifx\NAT@last@yr\NAT@year
%               \def\NAT@temp{{?}}%
%               \ifx\NAT@temp\NAT@exlab\PackageWarningNoLine{natbib}%
%                {Multiple citation on page \thepage: same authors and
%                year\MessageBreak without distinguishing extra
%                letter,\MessageBreak appears as question mark}\fi
%               \NAT@hyper@{\NAT@exlab}%
%             \else\unskip\NAT@spacechar
%               \NAT@hyper@{\NAT@date}%
%             \fi
%          \else
%            \@citea\NAT@hyper@{%
%              \NAT@nmfmt{\NAT@nm}%
%              \hyper@natlinkbreak{%
%                \NAT@aysep\NAT@spacechar}{\@citeb\@extra@b@citeb
%              }%
%              \NAT@date
%            }%
%          \fi
%        \fi
%      \or\@citea\NAT@hyper@{\NAT@nmfmt{\NAT@nm}}%
%      \or\@citea\NAT@hyper@{\NAT@date}%
%      \or\@citea\NAT@hyper@{\NAT@alias}%
%      \fi \NAT@def@citea
%      \else
%        \ifcase\NAT@ctype
%         \if\relax\NAT@date\relax
%           \@citea\NAT@hyper@{\NAT@nmfmt{\NAT@nm}}%
%         \else
%          \ifx\NAT@last@nm\NAT@nm\NAT@yrsep
%             \ifx\NAT@last@yr\NAT@year
%               \def\NAT@temp{{?}}%
%               \ifx\NAT@temp\NAT@exlab\PackageWarningNoLine{natbib}%
%                {Multiple citation on page \thepage: same authors and
%                year\MessageBreak without distinguishing extra
%                letter,\MessageBreak appears as question mark}\fi
%               \NAT@hyper@{\NAT@exlab}%
%             \else
%               \unskip\NAT@spacechar
%               \NAT@hyper@{\NAT@date}%
%             \fi
%          \else
%            \@citea\NAT@hyper@{%
%              \NAT@nmfmt{\NAT@nm}%
%              \hyper@natlinkbreak{\NAT@spacechar\NAT@@open\if*#1*\else#1\NAT@spacechar\fi}%
%                {\@citeb\@extra@b@citeb}%
%              \NAT@date
%            }%
%          \fi
%         \fi
%        \or\@citea\NAT@hyper@{\NAT@nmfmt{\NAT@nm}}%
%        \or\@citea\NAT@hyper@{\NAT@date}%
%        \or\@citea\NAT@hyper@{\NAT@alias}%
%        \fi
%        \if\relax\NAT@date\relax
%          \NAT@def@citea
%        \else
%          \NAT@def@citea@close
%        \fi
%      \fi
%      }}\ifNAT@swa\else\if*#2*\else\NAT@cmt#2\fi
%      \if\relax\NAT@date\relax\else\NAT@@close\fi\fi}{#1}{#2}}
